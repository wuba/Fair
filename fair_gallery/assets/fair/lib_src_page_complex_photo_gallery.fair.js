GLOBAL['#FairKey#']=(function(__initProps__){const __global__=this;return runCallback(function(__mod__){with(__mod__.imports){function _PhotoGalleryPageState(){const inner=_PhotoGalleryPageState.__inner__;if(this==__global__){return new _PhotoGalleryPageState({__args__:arguments});}else{const args=arguments.length>0?arguments[0].__args__||arguments:[];inner.apply(this,args);_PhotoGalleryPageState.prototype.ctor.apply(this,args);return this;}}_PhotoGalleryPageState.__inner__=function inner(){this._repository=null;this.lastRefreshTime=DateTime.now();this.fairProps=__initProps__;this._pageName='#FairKey#';this.pageIndex=0;this._itemIds=[];};_PhotoGalleryPageState.prototype={initState:function initState(){const __thiz__=this;with(__thiz__){fairProps=widget.fairProps;onLoad();}},onLoad:function onLoad(){const __thiz__=this;with(__thiz__){_repository=LoadingMoreRepository();}},dispose:function dispose(){const __thiz__=this;with(__thiz__){onUnload();}},onUnload:function onUnload(){const __thiz__=this;with(__thiz__){}},_onRefresh:function _onRefresh(){const __thiz__=this;with(__thiz__){return _repository.refresh();}},_onLoadData:function _onLoadData(input){const __thiz__=this;const __arg_ctx__={input,};with(__thiz__){with(__arg_ctx__){let futureId=input.__op_idx__('futureId');let isloadMoreAction=input.__op_idx__('isloadMoreAction');let url='';if(!isloadMoreAction){_itemIds.clear();pageIndex=0;}if(_itemIds.isEmpty){url='https://api.tuchong.com/feed-app';}else{let lastId=_itemIds.__op_idx__(_itemIds.length-1);url='https://api.tuchong.com/feed-app?post_id='+lastId.toString()+'&page='+pageIndex.toString()+'&type=loadmore';}FairCommonPlugin().http(convertObjectLiteralToSetOrMap({['method']:'GET',['url']:url,['pageName']:_pageName,['callback']:function dummy(result){if(result!=null){let statusCode=result.__op_idx__('statusCode');let list=[];if(statusCode==200){let map=result.__op_idx__('json');if(map!=null){let feedList=map.__op_idx__('feedList');for(let i=0;i<feedList.length;i++){let item=feedList.__op_idx__(i);let postId=item.__op_idx__('post_id');if(!_itemIds.contains(item.__op_idx__(postId))){list.add(item);_itemIds.add(postId);}}}pageIndex=pageIndex+1;}if(!isloadMoreAction){lastRefreshTime=DateTime.now();}FairCommonPlugin().futureComplete(convertObjectLiteralToSetOrMap({['pageName']:_pageName,['futureId']:futureId,['futureValue']:convertObjectLiteralToSetOrMap({['pageIndex']:pageIndex,['statusCode']:statusCode,['list']:list,}),}));}},}));}}},_getRouteName:function _getRouteName(){const __thiz__=this;with(__thiz__){if(fairProps!=null&&fairProps.__op_idx__('routeName')!=null){return fairProps.__op_idx__('routeName');}return'';}},};_PhotoGalleryPageState.prototype.ctor=function(){};;return _PhotoGalleryPageState();}},[]);})(convertObjectLiteralToSetOrMap(JSON.parse('#FairProps#')));